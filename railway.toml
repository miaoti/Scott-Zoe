[build]
# Railway will auto-detect Spring Boot application
builder = "nixpacks"

[deploy]
startCommand = "java -Dserver.port=$PORT -jar target/*.jar"
rootDirectory = "spring-backend"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10

# GitHub Integration
[environments.production]
# Railway will automatically deploy when you push to GitHub
# Environment variables are loaded from .env.production and can be overridden in Railway dashboard

[environments.production.variables]
# Core Application Settings
SPRING_PROFILES_ACTIVE = "production"
PORT = "8080"
UPLOAD_DIR = "/app/uploads"

# Database Configuration - Using SQLite for single service deployment
DATABASE_DRIVER = "org.sqlite.JDBC"
DATABASE_PLATFORM = "org.hibernate.community.dialect.SQLiteDialect"

# Security Configuration - IMPORTANT: Change this to a secure random string
JWT_SECRET = "couple-website-super-secret-jwt-key-for-production-2024-railway-change-me"

# CORS Configuration - allow Railway domain and common development origins
CORS_ORIGINS = "https://${{RAILWAY_PUBLIC_DOMAIN}},http://localhost:5173,http://localhost:3000"

[environments.production.deploy]
healthcheckPath = "/actuator/health"
healthcheckTimeout = 300